---
import { Image } from "@unpic/astro"
import BaseLayout from "@layouts/BaseLayout.astro"

import { getActivePrices } from "@utils/stripe"
import { formatCurrency } from "@utils/intl"
import { getLocalCurrency } from "@utils/currency"

const prices = await getActivePrices()

const {
    geo: { country },
} = Astro.locals.netlify.context

const currency = getLocalCurrency(country?.name)
---

<BaseLayout
    title="Shop | Giclée Fine Art Prints | Andrea Diotallevi Art"
    description="Archival quality giclée generative art prints, on vegan certified Hahnemühle photo rag 308gsm matte paper, delivered in a cardboard tube with recycled plastic ends."
    image={prices[0].product.images[0]}
>
    <div class="max-w-screen-xl mx-auto px-4 py-8">
        <div class="text-center mb-8">
            <h1 class="text-5xl font-bold mb-6">Shop</h1>
            <p class="max-w-[600px] mx-auto">
                Archival quality giclée generative art prints, on vegan
                certified Hahnemühle photo rag 308gsm matte paper, delivered in
                recycled packaging
            </p>
        </div>

        <div class="grid grid-cols-2 md:grid-cols-4 gap-8">
            {
                prices.map(price => (
                    <a
                        href={`/shop/${price.product.metadata.category}/${price.product.metadata.slug}`}
                        class="flex flex-col no-underline text-black hover:underline"
                        data-astro-prefetch
                    >
                        <Image
                            alt={price.product.name}
                            src={price.product.images[0]}
                            width={1000}
                            height={1414}
                            class="w-full h-auto object-contain"
                        />
                        <h2 class="text-2xl font-semibold mt-4">
                            {price.product.metadata.displayName}
                        </h2>
                        <p class="text-lg font-medium mt-2">
                            {formatCurrency({
                                value: price.currency_options[currency]
                                    .unit_amount,
                                currency,
                            })}
                        </p>
                    </a>
                ))
            }
        </div>
    </div>
</BaseLayout>
