---
export const prerender = true

import { getStripeProducts } from "@utils/serverless"
import type { Currency } from "@utils/stripe"
import { supportedLocales, defaultLocale, localeToCurrency } from "@utils/currency"
import ShopView from "@components/shop/ShopView.astro"

export async function getStaticPaths() {
    return supportedLocales
        .filter(locale => locale !== defaultLocale)
        .map(locale => ({ params: { locale } }))
}

const locale = Astro.params.locale as keyof typeof localeToCurrency
const currency = localeToCurrency[locale] as Currency
const products = await getStripeProducts()
---

<ShopView locale={String(locale)} currency={currency} products={products} />
